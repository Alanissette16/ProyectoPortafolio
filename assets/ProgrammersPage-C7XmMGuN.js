import{r as m,j as e}from"./index-D4BcGv0C.js";import{a as X,d as J,f as Y}from"./index-DiLYulTt.js";import{b as Z,u as ee,f as ae}from"./firestore-BGiPDi5h.js";import{F as c}from"./FormUtils-X4tq9MxD.js";import{g as F,c as se}from"./photoStorage-rzgObget.js";const B={displayName:"",lastName:"",email:"",specialty:"",bio:"",quote:"",location:"",role:"programmer",photoURL:"",github:"",instagram:"",linkedin:"",whatsapp:"",projects:"",experience:"",clients:""},ce=()=>{const[s,y]=m.useState(B),[E,T]=m.useState([]),[I,R]=m.useState(!1),[A,L]=m.useState(""),[D,g]=m.useState(""),[P,U]=m.useState(null),[_,v]=m.useState(""),[t,u]=m.useState({}),[i,N]=m.useState({}),[j,$]=m.useState(null),[p,h]=m.useState([{name:"JavaScript",level:80},{name:"React",level:85}]),[w,S]=m.useState(""),[G,k]=m.useState(80),C={displayName:[a=>c.required(a),a=>c.minLength(a,2)],lastName:[a=>c.required(a)],email:[a=>c.required(a),a=>c.email(a)],specialty:[a=>c.required(a),a=>c.minLength(a,3)],bio:[a=>c.minLength(a,10)],location:[],quote:[],github:[a=>a&&c.url(a)],instagram:[a=>a&&c.url(a)],linkedin:[a=>a&&c.url(a)],whatsapp:[a=>a&&c.url(a)]},q=async()=>{const a=await Z();T(a)};m.useEffect(()=>{q()},[]);const H=()=>{!w.trim()||w.length<2||(h([...p,{name:w.trim(),level:G}]),S(""),k(80))},M=a=>{h(p.filter((l,r)=>r!==a))},o=a=>{const{name:l,value:r}=a.target;if(y(n=>({...n,[l]:r})),i[l]){const n=C[l];if(n){const f=c.validate(r,n);u(x=>({...x,[l]:f||""}))}}},d=a=>{N(r=>({...r,[a]:!0}));const l=C[a];if(l){const r=c.validate(s[a],l);u(n=>({...n,[a]:r||""}))}},z=a=>{const l=a.target.files?.[0];if(l){U(l);const r=new FileReader;r.onloadend=()=>{v(r.result)},r.readAsDataURL(l)}},W=async a=>{a.preventDefault();const l=Object.keys(C).reduce((n,f)=>(n[f]=!0,n),{});N(l);const r=c.validateForm(s,C);if(u(r),p.length<2&&(r.skills="Debe tener al menos 2 habilidades"),c.hasErrors(r)){g("Por favor corrige los errores en el formulario.");return}R(!0),g(""),L("");try{const n=j||`prog_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let f=s.photoURL;if(P)try{const b=await se(P,200,.7);localStorage.setItem(`photo_${n}`,b),f=b}catch(b){console.error("Error comprimiendo imagen:",b),g("Error al procesar la imagen. Intenta con una mÃ¡s pequeÃ±a."),R(!1);return}const x={};s.github&&(x.github=s.github),s.instagram&&(x.instagram=s.instagram),s.linkedin&&(x.linkedin=s.linkedin),s.whatsapp&&(x.whatsapp=s.whatsapp);const V={projects:parseInt(s.projects)||0,experience:s.experience||"1 aÃ±o",clients:parseInt(s.clients)||0};await ee(n,{displayName:s.displayName,lastName:s.lastName,email:s.email,specialty:s.specialty,bio:s.bio,quote:s.quote,location:s.location,role:"programmer",photoURL:P?`local:${n}`:s.photoURL,skills:p.map(b=>b.name),socials:x,stats:V}),L(j?"âœ“ Programador actualizado correctamente.":"âœ“ Programador guardado correctamente."),y(B),h([{name:"JavaScript",level:80},{name:"React",level:85}]),S(""),k(80),U(null),v(""),u({}),N({}),$(null),await q()}catch(n){console.error("Error al guardar programador:",n),g(`Error al guardar: ${n.message||"Verifica permisos de Firebase"}`)}finally{R(!1)}},K=a=>{$(a.id),y({displayName:a.displayName||"",lastName:a.lastName||"",email:a.email||"",specialty:a.specialty||"",location:a.location||"",bio:a.bio||"",quote:a.quote||"",role:"programmer",photoURL:a.photoURL||"",github:a.socials?.github||"",instagram:a.socials?.instagram||"",linkedin:a.socials?.linkedin||"",whatsapp:a.socials?.whatsapp||"",projects:a.stats?.projects?.toString()||"0",experience:a.stats?.experience||"1 aÃ±o",clients:a.stats?.clients?.toString()||"0"});const l=a.skills||[{name:"JavaScript",level:80}];h(Array.isArray(l)?l.map(r=>typeof r=="string"?{name:r,level:80}:r):[{name:"JavaScript",level:80}]),v(F(a.photoURL)),u({}),N({}),window.scrollTo({top:0,behavior:"smooth"})},O=async(a,l)=>{if(confirm(`Â¿EstÃ¡s seguro de eliminar a ${l}?`))try{await ae(a),L(`âœ“ ${l} eliminado correctamente.`),await q()}catch{g("No se pudo eliminar el programador.")}},Q=()=>{$(null),y(B),h([{name:"JavaScript",level:80},{name:"React",level:85}]),S(""),k(80),U(null),v(""),u({}),N({})};return e.jsxs("div",{className:"space-y-6 pt-20",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:W,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:j?"Editar programador":"Nuevo programador"}),A&&e.jsx("div",{className:"alert alert-success text-sm",children:A}),D&&e.jsx("div",{className:"alert alert-error text-sm",children:D}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:_||s.photoURL?e.jsx("img",{src:_||F(s.photoURL),alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:z,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:s.displayName,onChange:o,onBlur:()=>d("displayName"),className:`input input-bordered ${i.displayName&&t.displayName?"input-error":""}`}),i.displayName&&t.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Apellido *"})}),e.jsx("input",{name:"lastName",value:s.lastName,onChange:o,onBlur:()=>d("lastName"),className:`input input-bordered ${i.lastName&&t.lastName?"input-error":""}`}),i.lastName&&t.lastName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.lastName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:o,onBlur:()=>d("email"),className:`input input-bordered ${i.email&&t.email?"input-error":""}`}),i.email&&t.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:s.specialty,onChange:o,onBlur:()=>d("specialty"),className:`input input-bordered ${i.specialty&&t.specialty?"input-error":""}`}),i.specialty&&t.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:s.bio,onChange:o,onBlur:()=>d("bio"),className:`textarea textarea-bordered ${i.bio&&t.bio?"textarea-error":""}`,rows:3}),i.bio&&t.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.bio})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"UbicaciÃ³n"})}),e.jsx("input",{name:"location",value:s.location,onChange:o,className:"input input-bordered",placeholder:"Ej: Guayaquil, Ecuador"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Frase / Quote"})}),e.jsx("input",{name:"quote",value:s.quote,onChange:o,className:"input input-bordered",placeholder:"Una frase que te represente"})]}),e.jsx("div",{className:"divider",children:"EstadÃ­sticas"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Proyectos"})}),e.jsx("input",{type:"number",name:"projects",value:s.projects,onChange:o,className:"input input-bordered",placeholder:"15",min:"0"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Experiencia"})}),e.jsx("input",{name:"experience",value:s.experience,onChange:o,className:"input input-bordered",placeholder:"2 aÃ±os"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Clientes"})}),e.jsx("input",{type:"number",name:"clients",value:s.clients,onChange:o,className:"input input-bordered",placeholder:"10",min:"0"})]})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:w,onChange:a=>S(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),H())},className:"input input-bordered flex-1",placeholder:"Nombre de habilidad (ej: TypeScript)"}),e.jsx("input",{type:"number",value:G,onChange:a=>k(Math.min(100,Math.max(0,parseInt(a.target.value)||0))),className:"input input-bordered w-20",placeholder:"Nivel",min:"0",max:"100"}),e.jsxs("button",{type:"button",onClick:H,className:"btn btn-primary",children:[e.jsx(X,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[p.map((a,l)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"text",value:a.name,onChange:r=>{const n=[...p];n[l]={...a,name:r.target.value},h(n)},className:"input input-bordered flex-1"}),e.jsx("input",{type:"range",min:"0",max:"100",value:a.level,onChange:r=>{const n=[...p];n[l]={...a,level:parseInt(r.target.value)},h(n)},className:"range range-primary range-sm w-32"}),e.jsxs("span",{className:"text-sm font-medium w-12",children:[a.level,"%"]}),e.jsx("button",{type:"button",onClick:()=>M(l),className:"btn btn-error btn-sm",children:e.jsx(J,{})})]},l)),p.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:s.github,onChange:o,onBlur:()=>d("github"),className:`input input-bordered ${i.github&&t.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),i.github&&t.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:s.instagram,onChange:o,onBlur:()=>d("instagram"),className:`input input-bordered ${i.instagram&&t.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),i.instagram&&t.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"LinkedIn"})}),e.jsx("input",{name:"linkedin",value:s.linkedin,onChange:o,onBlur:()=>d("linkedin"),className:`input input-bordered ${i.linkedin&&t.linkedin?"input-error":""}`,placeholder:"https://linkedin.com/in/usuario"}),i.linkedin&&t.linkedin&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.linkedin})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:s.whatsapp,onChange:o,onBlur:()=>d("whatsapp"),className:`input input-bordered ${i.whatsapp&&t.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),i.whatsapp&&t.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.whatsapp})})]}),e.jsxs("div",{className:"card-actions justify-end gap-2",children:[j&&e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:Q,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:I,children:I?"Guardando...":j?"Actualizar":"Guardar programador"})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:E.length})]}),e.jsxs("div",{className:"space-y-2",children:[E.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:F(a.photoURL),alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((l,r)=>e.jsxs("span",{className:"badge badge-primary badge-sm",children:[typeof l=="string"?l:l.name,typeof l!="string"&&l.level?` ${l.level}%`:""]},r))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>K(a),className:"btn btn-sm btn-primary gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>O(a.id,a.displayName),className:"btn btn-sm btn-error gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Eliminar"]})]})]})]})},a.id)),!E.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{ce as default};
